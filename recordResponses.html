<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Legacy Voices - Record Your Story</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

<h1>Legacy Voices - Tell Your Story</h1>

<label for="storySummary">Provide a brief summary of your experience:</label>
<textarea id="storySummary" placeholder="Example: 'I lost my job and was struggling financially, but something unexpected happened that changed everything.'"></textarea>

<h3>Answer the following questions to expand your story:</h3>

<div id="questionContainer"></div>

<button id="submitStory">Submit & Generate Story</button>

<script>
let questions = [
    "1. Can you describe the initial thoughts and emotions you experienced when you lost your job and were faced with financial uncertainty?",
    "2. How did your faith guide your actions and mindset during this challenging time of financial struggle?",
    "3. Were there any unexpected encounters or events that you now see as divine preparation to help you navigate through this difficult period?",
    "4. Can you share a specific moment or experience that stands out to you as a miraculous resolution to your financial struggles?",
    "5. Looking back, how has this experience of overcoming financial hardship and relying on your faith left a lasting impact on your spiritual journey and perspective on challenges in life?"
];

let answers = [];

function displayQuestions() {
    let container = document.getElementById("questionContainer");
    questions.forEach((question, index) => {
        let questionLabel = document.createElement("label");
        questionLabel.innerText = question;
        
        let answerBox = document.createElement("textarea");
        answerBox.setAttribute("id", `answer-${index}`);
        answerBox.setAttribute("placeholder", "Your response here...");

        container.appendChild(questionLabel);
        container.appendChild(answerBox);
    });
}

document.getElementById("submitStory").addEventListener("click", function() {
    let storySummary = document.getElementById("storySummary").value;
    
    let responses = [];
    for (let i = 0; i < questions.length; i++) {
        let response = document.getElementById(`answer-${i}`).value;
        responses.push(response);
    }

    fetch("https://legacy-voices-backend.onrender.com/generate-story", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
            storySummary: storySummary,
            responses: responses
        })
    })
    .then(response => response.json())
    .then(data => {
        localStorage.setItem("generatedStory", data.finalStory);
        window.location.href = "storySummary.html"; // Redirect to story review page
    });
});

displayQuestions();
</script>

</body>
</html>
