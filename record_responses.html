
<!DOCTYPE html>
<html lang="en">
<head>
    <title>Legacy Voices - Record Responses</title>
    <link rel="stylesheet" href="styles.css">
    <script src="record.js"></script>
</head>
<body>
    <h1>Legacy Voices - Record Your Answers</h1>
    <div id="questionContainer">
        <p id="questionText" style="font-weight: bold;"></p>
    </div>
    <textarea id="responseText" rows="5" cols="50" readonly></textarea><br>
    <button onclick="startRecordingQuestion()">üé§ Start Recording</button>
    <button onclick="stopRecordingQuestion()">‚èπÔ∏è Stop Recording</button>
    <button onclick="nextQuestion()">Next Question</button>

    <script>
        let questions = JSON.parse(sessionStorage.getItem('questions'));
        let questionIndex = 0;
        let responses = [];

        if (!questions || questions.length !== 5) {
            alert('No questions found or incorrect number. Please start from the beginning.');
            window.location.href = 'questions.html';
        }

        let recognition;

        function displayQuestion() {
            document.getElementById('questionText').innerText = questions[questionIndex];
            document.getElementById('responseText').value = '';
        }

        function startRecordingQuestion() {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            recognition = new SpeechRecognition();
            recognition.interimResults = true;
            recognition.lang = 'en-US';

            recognition.onresult = (event) => {
                let transcript = '';
                for (let i = event.resultIndex; i < event.results.length; ++i) {
                    transcript += event.results[i][0].transcript;
                }
                document.getElementById('responseText').value = transcript;
            };

            recognition.start();
        }

        function stopRecordingQuestion() {
            if (recognition) {
                recognition.stop();
            }
        }

        function nextQuestion() {
            responses.push(document.getElementById('responseText').value);

            questionIndex++;
            if (questionIndex < questions.length) {
                displayQuestion();
            } else {
                sessionStorage.setItem('responses', JSON.stringify(responses));
                window.location.href = 'review.html';
            }
        }

        displayQuestion();
    </script>
</body>
</html>
